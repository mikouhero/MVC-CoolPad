# 分表

## 垂直分表

`根据数据库里面数据表的相关性进行拆分`。 例如，用户表中既有用户的登录信息又有用户的基本信息，可以将用户表拆分成两个单独的表，甚至放到单独的库做分库。    

`简单来说垂直拆分是指数据表列的拆分，把一张列比较多的表拆分为多张表`。 如下图所示，这样来说大家应该就更容易理解了。

![](https://user-gold-cdn.xitu.io/2018/6/16/164084354ba2e0fd)


垂直拆分的优点： 
   -  可以使得行数据变小，在查询时减少读取的Block数，减少I/O次数。
   -  此外，垂直分区可以简化表的结构，易于维护。    

垂直拆分的缺点：
 - 主键会出现冗余，需要管理冗余列，并会引起Join操作，可以通过在应用层进行Join来解决。
 - 此外，垂直分区会让事务变得更加复杂；
 
 
### 水平分区  

`保持数据表结构不变，通过某种策略存储数据分片。这样每一片数据分散到不同的表或者库中，达到了分布式的目的。 水平拆分可以支撑非常大的数据量。`     
水平拆分是指数据表行的拆分，表的行数超过200万行时，就会变慢，这时可以把一张的表的数据拆成多张表来存放。举个例子：我们可以将用户信息表拆分成多个用户信息表，这样就可以避免单一表数据量过大对性能造成影响。

![](https://user-gold-cdn.xitu.io/2018/6/16/164084b7e9e423e3)

水品拆分可以支持非常大的数据量。需要注意的一点是:分表仅仅是解决了单一表数据过大的问题，但由于表的数据还是在同一台机器上，其实对于提升MySQL并发能力没有什么意义，所以 `水平拆分`最好分库 。

水平拆分能够 `支持非常大的数据量存储，应用端改造也少`，但 `分片事务难以解决`  ，跨界点Join性能较差，逻辑复杂。` 尽量不要对数据进行分片，因为拆分会带来逻辑、部署、运维的各种复杂度` ，一般的数据表在优化得当的情况下支撑千万以下的数据量是没有太大问题的。如果实在要分片，尽量选择客户端分片架构，这样可以减少一次和中间件的网络I/O。

