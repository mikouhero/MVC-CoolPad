# 一条SQL语句执行得很慢的原因有哪些？



### 针对偶尔很慢

-  数据库在刷脏页 

> 当我们要往数据库插入一条数据、或者要更新一条数据的时候，我们知道数据库会在`内存`中把对应字段的数据更新了，但是更新之后，这些更新的字段并`不会马上同步持久化到磁盘`中去，而是把这些更新的记录写入到` redo log `日志中去，等到空闲的时候，在通过 redo log 里的日记把最新的数据同步到磁盘中去。     
>不过，redo log 里的容量是有限的，如果数据库一直很忙，更新又很频繁，这个时候 redo log 很快就会被写满了，这个时候就没办法等到空闲的时候再把数据同步到磁盘的，只能暂停其他操作，全身心来把数据同步到磁盘中去的，而这个时候，`就会导致我们平时正常的SQL语句突然执行的很慢`，所以说，数据库在在同步数据到磁盘的时候，就有可能导致我们的SQL语句执行的很慢了。


- 等待锁
> 这个就比较容易想到了，我们要执行的这条语句，刚好这条语句涉及到的表，别人在用，并且加锁了，我们拿不到锁，只能慢慢等待别人释放锁了。或者，表没有加锁，但要使用到的某个一行被加锁了，这个时候，我也没办法啊。     
如果要判断是否真的在等待锁，我们可以用 show processlist这个命令来查看当前的状态


## 针对一直都这么慢的情况

- 字段没有索引
> 随着数量的增大 ，时间越来越慢

- 字段有索引，但却没有用索引 
  + 错误的操作
    > 由于对字段进行运算、函数操作导致无法用索引
    
  +  数据库选错索引 
    > 由于统计的失误，导致系统没有走索引，而是走了全表扫描
    > analyze table t;
 
